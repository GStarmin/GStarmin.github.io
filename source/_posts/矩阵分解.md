---
title: 矩阵分解
categories: [数学， 矩阵论]
tags: 矩阵论
---

<!-- <link href="https://lf9-cdn-tos.bytecdntp.com/cdn/expire-1-M/KaTeX/0.10.2/katex.min.css" rel="stylesheet"> -->

## 正交三角分解(QR分解)
### 满秩矩阵的 QR 分解
若 $n$ 阶实矩阵 $A\in \mathbb {C}^{n\times n}$ 满秩，且 $$A = [\alpha_1,...,\alpha_n]$$

其中 $\alpha_1,...,\alpha_n$ 是 $\mathbb {C}^{n\times n}$  中线性无关向量组

**正交化**

令

$$ \begin{aligned} \beta_1&=\alpha_1\\ \beta_2&=\alpha_2 - \frac{\left<\beta_1,\alpha_1\right>}{\left<\beta_1,\beta_1\right>}\beta_1 \\ \vdots \\ \beta_n &= \alpha_n - \frac{\left<\beta_n,\alpha_1\right>}{\left<\beta_1,\beta_1\right>}\beta_1-\cdots-\frac{\left<\beta_{n-1},\alpha_n\right>}{\left<\beta_{n-1},\alpha_{n-1}\right>}\beta_{n-1} \end{aligned} $$

变形得 

$$ \begin{aligned} \alpha_1 &= \beta_1\\ \alpha_2 &= \frac{\left<\beta_1,\alpha_1\right>}{\left<\beta_1,\beta_1\right>}\beta_1 + \beta_2\\ \vdots \\ \alpha_n &= \frac{\left<\beta_n,\alpha_1\right>}{\left<\beta_1,\beta_1\right>}\beta_1-\cdots-\frac{\left<\beta_{n-1},\alpha_n\right>}{\left<\beta_{n-1},\alpha_{n-1}\right>}\beta_{n-1} + \beta_n \end{aligned} $$

写成矩阵形式

$$ \begin{aligned} \begin{bmatrix}\alpha_1,\alpha_2,...,\alpha_n\end{bmatrix} &= \begin{bmatrix}\beta_1,\beta_2,...,\beta_n\end{bmatrix}\begin{bmatrix}1&\frac{\left<\beta_1,\alpha_1\right>}{\left<\beta_1,\beta_1\right>}&\cdots &\frac{\left<\beta_1,\alpha_n\right>}{\left<\beta_1,\beta_1\right>}\\0&1&\cdots&\frac{\left<\beta_2,\alpha_n\right>}{\left<\beta_2,\beta_2\right>}\\ &&\ddots\\0&&\cdots& 1\end{bmatrix}\\ &\triangleq B\begin{bmatrix}1&\frac{\left<\beta_1,\alpha_1\right>}{\left<\beta_1,\beta_1\right>}&\cdots &\frac{\left<\beta_1,\alpha_n\right>}{\left<\beta_1,\beta_1\right>}\\0&1&\cdots&\frac{\left<\beta_2,\alpha_n\right>}{\left<\beta_2,\beta_2\right>}\\ &&\ddots\\0&&\cdots& 1\end{bmatrix} \end{aligned} $$

**单位化**

令 

$$ q_1=\frac{\beta_1}{||\beta_1||}\\ \vdots \\ q_n = \frac{\beta_n}{||\beta_n||} $$

变形得 

$$ \beta_1 = q_1||\beta_1||\\ \vdots \\ \beta_n = q_n ||\beta_n|| $$

写成矩阵形式 

$$ \begin{aligned} \begin{bmatrix}\beta_1,\beta_2,...,\beta_n\end{bmatrix} &= \begin{bmatrix}q_1,q_2,...,q_n\end{bmatrix}\begin{bmatrix}||\beta_1||&0&\cdots &0\\0&||\beta_2||&\cdots&0\\ &&\ddots\\0&&\cdots& ||\beta_n||\end{bmatrix}\\ &\triangleq Q\begin{bmatrix}||\beta_1||&0&\cdots &0\\0&||\beta_2||&\cdots&0\\ &&\ddots\\0&&\cdots& ||\beta_n||\end{bmatrix} \end{aligned} $$

综上，结合正交化和单位化可得 

$$ \begin{aligned} A &= B\begin{bmatrix}1&\frac{\left<\beta_1,\alpha_1\right>}{\left<\beta_1,\beta_1\right>}&\cdots &\frac{\left<\beta_1,\alpha_n\right>}{\left<\beta_1,\beta_1\right>}\\0&1&\cdots&\frac{\left<\beta_2,\alpha_n\right>}{\left<\beta_2,\beta_2\right>}\\ &&\ddots\\0&&\cdots& 1\end{bmatrix}\\ &=Q\begin{bmatrix}||\beta_1||&0&\cdots &0\\0&||\beta_2||&\cdots&0\\ &&\ddots\\0&&\cdots& ||\beta_n||\end{bmatrix}\begin{bmatrix}1&\frac{\left<\beta_1,\alpha_1\right>}{\left<\beta_1,\beta_1\right>}&\cdots &\frac{\left<\beta_1,\alpha_n\right>}{\left<\beta_1,\beta_1\right>}\\0&1&\cdots&\frac{\left<\beta_2,\alpha_n\right>}{\left<\beta_2,\beta_2\right>}\\ &&\ddots\\0&&\cdots& 1\end{bmatrix}\\ &=Q\begin{bmatrix}||\beta_1||&\frac{\left<\beta_1,\alpha_1\right>}{\left<\beta_1,\beta_1\right>}&\cdots &\frac{\left<\beta_1,\alpha_n\right>}{\left<\beta_1,\beta_1\right>}\\0&||\beta_2||&\cdots&\frac{\left<\beta_2,\alpha_n\right>}{\left<\beta_2,\beta_2\right>}\\ &&\ddots\\0&&\cdots& ||\beta_n||\end{bmatrix}\\ &\triangleq QR \end{aligned} $$

**QR 分解定理** : $A\in \mathbb {C}^{n\times n}$ ,则存在酉矩阵 $Q$ 和正线上三角阵 $R$ ，使 $$A=QR$$

且分解唯一

### QR 分解的求法
1. 取矩阵 $A=(A_1,A_2,...,A_n)$ 的列向量，进行 **Schmidt 标准正交化**,得 $v_1,v_2,...,v_n$ ，有 $$Q=(v_1,v_2,...,v_n)$$
2. 再由 $R=Q^HA$ 得到 $R$ , 于是 $A=QR$


## 矩阵的满秩分解
设 $A\in \mathbb {C}_r^{m\times n}$，则存在 $B\in \mathbb {C}_r^{m\times r}, C\in \mathbb {C}_r^{r\times n}$，满足
$$ A = BC $$

$\mathbb {C}_r$ 表示矩阵的秩为 $r$

实际上上述定理用文字描述就是，一个亏秩的矩阵可以分解成一个列满秩与行满秩矩阵的乘积

证明：因为 $rank (A)=r$，所以一定可以找到与 $A$ 相似的一个矩阵

$$ A \simeq \begin{bmatrix}E_r&0_{r\times (n-r)}\\0_{(m-r)\times r}&0_{(m-r)\times (n-r)}\end{bmatrix}=\begin{bmatrix}E_r\\0_{(m-r)\times r}\end{bmatrix}\begin{bmatrix}E_r&0_{r\times (n-r)}\end{bmatrix} $$

因此存在两个可逆矩阵 $P,Q$，使 $PAQ=\begin {bmatrix} E_r&0\\0&0\end {bmatrix}$，则

$$ \begin{aligned} A &= P^{-1}\begin{bmatrix}E_r\\0\end{bmatrix}\begin{bmatrix}E_r&0\end{bmatrix}Q^{-1}\\ &\triangleq BC \end{aligned} $$

因为 $P^{-1}$ 是可逆矩阵，$\begin {bmatrix} E_r\\0\end {bmatrix}$ 是一个列满秩矩阵，所以 $B=P^{-1}\begin {bmatrix} E_r\\0\end {bmatrix}$ 仍是一个列满秩矩阵；同理，$C=\begin {bmatrix} E_r&0\end {bmatrix} Q^{-1}$ 是一个行满秩矩阵

### 矩阵满秩分解的计算
如何在给定矩阵 $A$ 的情况下，求出矩阵 $B,C$ 呢？

设

$$ A = [\alpha_1,\alpha_2,...,\alpha_n]\\ B = [\beta_1,\beta_2,...,\beta_r]$$

其中 \beta_1,...,\beta_r 线性无关 

所以 
$$ \begin{aligned} &A=BC\\ &\Rightarrow[\alpha_1,\alpha_2,...,\alpha_n]=[\beta_1,...,\beta_r]\begin{bmatrix}c_{11}&\cdots &c_{1n}\\\vdots &\ddots&\vdots\\c_{r1}&\cdots &c_{rn}\end{bmatrix} \end{aligned} $$

实际上我们可以取 $\beta_1,...,\beta_r$ 为 $\alpha_1,...,\alpha_n$ 的一个极大线性无关组，因此 $B$ 就是矩阵 $A$ 列向量组的一个极大线性无关组，$C$ 就是用该线性无关组去表示 $A$ 时的系数

#### 例 1

求矩阵 $A=\begin {bmatrix} 1&4&-1&5&6\\2&0&0&0&-14\\-1&2&-4&0&1\\2&6&-5&5&-7\end {bmatrix}$ 的满秩分解

**解**：对矩阵 $A$ 只作初等行变换
$$ A=\begin{bmatrix}1&4&-1&5&6\\2&0&0&0&-14\\-1&2&-4&0&1\\2&6&-5&5&-7\end{bmatrix}\to ···\to\begin{bmatrix}1&0&0&0&-7\\0&1&0&\frac{10}{7}&\frac{29}{7}\\0&0&1&\frac{5}{7}&\frac{25}{7}\\0&0&0&0&0\end{bmatrix} $$

$A$ 的秩为 3，且前三个列向量线性无关，故
$$ B = \begin{bmatrix}1&4&-1\\2&0&0\\-1&2&-4\\2&6&-5\end{bmatrix}，C=\begin{bmatrix}1&0&0&0&-7\\0&1&0&\frac{10}{7}&\frac{29}{7}\\0&0&1&\frac{5}{7}&\frac{25}{7}\end{bmatrix} $$

#### 例 2
求矩阵 $A=\begin {bmatrix} 2&1&-2&3&1\\2&5&-1&4&1\\1&3&-1&2&1\end {bmatrix}$ 的满秩分解

**解**：对矩阵 $A$ 只作初等行变换

$$ A=\begin{bmatrix}2&1&-2&3&1\\2&5&-1&4&1\\1&3&-1&2&1\end{bmatrix}\to ···\to \begin{bmatrix}1&0&0&\frac{8}{5}&-\frac{2}{5}\\0&1&0&\frac{1}{5}&\frac{1}{5}\\0&0&1&\frac{1}{5}&-\frac{4}{5}\end{bmatrix} $$

$A$ 的秩为 3，且前三个列向量线性无关，故
$$ B = \begin{bmatrix}2&1&-2\\2&5&-1\\1&3&-1\end{bmatrix},C = \begin{bmatrix}1&0&0&\frac{8}{5}&-\frac{2}{5}\\0&1&0&\frac{1}{5}&\frac{1}{5}\\0&0&1&\frac{1}{5}&-\frac{4}{5}\end{bmatrix} $$

## 矩阵的LU分解
LU 分解（LU Decomposition）是矩阵分解的一种，可以将一个矩阵分解为一个单位下三角矩阵和一个上三角矩阵的乘积，以四阶矩阵为例
$$ L = \begin{bmatrix}1&0&0&0\\*&1&0&0\\*&*&1&0\\*&*&*&1\end{bmatrix}, U=\begin{bmatrix}*&*&*&*\\0&*&*&*\\0&0&*&*\\0&0&0&*\end{bmatrix} $$

LU 矩阵是否一定存在？答案是否，具体看下面的例子

设 $\begin {bmatrix} 0&1\\1&0\end {bmatrix}=\begin {bmatrix} a&0\\b&c\end {bmatrix}\begin {bmatrix} l&m\\0&n\end {bmatrix}$，则应该满足如下 4 个式子

$$ \begin{cases} al=0\\ am=1\\ bl=1\\ bm+cn=0 \end{cases} $$

由 $al=0$ 得 $a=0$ 或 $l=0$，但实际上这两种情况带入上面的式子都会推出矛盾，因此不是所有情况 LU 分解都存在

**LU 分解定理** ：设 $A\in \mathbb {C}_n^{n\times n}$，$A$ 有唯一的 LU 分解 $\Leftrightarrow A$ 的各阶顺序主子式 $\Delta k \neq 0,\ k=1,2...,n$

$k$ 阶顺序主子式指的是矩阵左上角 $k\times k$ 个元素组成的行列式

将矩阵 $A$ 分解为 $L$ 和 $U$ 之后，解方程组 $Ax=b$ 就变得简单了，因为 $A=LU$，所以 $(LU) x=b\Rightarrow L (Ux)=b\Rightarrow \begin {cases} Ly=b\\Ux=y\end {cases}$

所以 $x=U^{-1} y=U^{-1} L^{-1} b$

### LU 矩阵的求法
实际上 LU 矩阵有非常多的求法，这里列举一种比较简单的待定系数法

设 $A = \begin {bmatrix} 2&3&4\\1&1&9\\1&2&-6\end {bmatrix}$，求矩阵 $A$ 的 LU 分解矩阵 $L$ 和 $U$

**解**：令
$$ L=\begin{bmatrix}1&0&0\\l_1&1&0\\l_2&l_3&1\end{bmatrix},U = \begin{bmatrix}u_1&u_2&u_3\\0&u_4&u_5\\0&0&u_6\end{bmatrix} $$

由于 $A=LU$，所以有

$$ \begin{cases} u_1=2\\ u_2=3\\ u_3=4\\ l_1u_1=1\\ l_1u_2+u_4=1\\ l_1u_3+u_5=9\\ l_2u_1=1\\ l_2u_2+l_3u_4=2\\ l_2u_3+l_3u_5+u_6=-6 \end{cases} $$

上面的方程组非常容易解，最后求出

$$ L = \begin{bmatrix}1&0&0\\\frac{1}{2}&1&0\\\frac{1}{2}&-1&1\end{bmatrix},U=\begin{bmatrix}2&3&4\\0&-\frac{1}{2}&7\\0&0&-1\end{bmatrix} $$

